<form [formGroup]="salaryForm" (ngSubmit)="calculate()" class="salary-form">
  <h2>Calcolo Netto da RAL</h2>

  <div class="form-grid">
    <div class="form-field">
      <label>RAL (€)</label>
      <input type="number" formControlName="ral" />
    </div>

    <div class="form-field">
      <label>Mensilità</label>
      <input type="number" formControlName="mensilita" />
    </div>

    <div class="form-field">
      <label>Aliquota INPS</label>
      <input type="number" step="0.001" formControlName="aliquotaINPS" />
    </div>

    <div class="form-field">
      <label>Regione</label>
      <select formControlName="regione">
        <option value="" disabled>Seleziona regione</option>
        <option *ngFor="let regione of regioni" [value]="regione">
          {{ regione }}
        </option>
      </select>
    </div>


    <div class="form-field">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Comune di residenza</mat-label>

        <input type="text" matInput [formControl]="comuneCtrl" [matAutocomplete]="auto" />

        <mat-autocomplete 
              #auto="matAutocomplete" 
              [displayWith]="displayComune"
              (optionSelected)="onComuneSelected($event.option.value)">
          <mat-option *ngFor="let comune of filteredComuni | async" [value]="comune">
            {{ comune.comune }} ({{ comune.provincia }})
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>


    <div class="form-field checkbox">
      <label>
        <input type="checkbox" formControlName="coniugeACarico" />
        Coniuge a carico
      </label>
    </div>

    <div class="form-field">
      <label>Figli a carico</label>
      <input type="number" formControlName="figliACarico" />
    </div>

    <div class="form-field">
      <label>Figli disabili</label>
      <input type="number" formControlName="figliDisabili" />
    </div>

    <div class="form-field">
      <label>Altri familiari a carico</label>
      <input type="number" formControlName="altriFamiliariACarico" />
    </div>

    <div class="form-field">
      <label>Bonus vari (€)</label>
      <input type="number" formControlName="bonusVari" />
    </div>
  </div>

  <button type="submit" class="submit-btn">Calcola Netto</button>
</form>

<div *ngIf="result" class="result-box" #resultSection>
  <h3>Risultato</h3>

  <div class="result-grid">
    <p><strong>Netto Annuo:</strong> € {{ result.nettoAnnuo.toFixed(0) }}</p>
    <p><strong>Netto Mensile:</strong> € {{ result.nettoMensile.toFixed(0) }}</p>
    <p><strong>Contributi INPS:</strong> € {{ result.contributiINPS.toFixed(0) }}</p>
    <p><strong>Ritenute IRPEF:</strong> € {{ result.irpefNetta.toFixed(0) }}</p>
    <p><strong>Addizionali:</strong> € {{ result.addizionali.toFixed(0) }}</p>
    <p><strong>Detrazioni Totali:</strong> € {{ result.detrazioni.toFixed(0) }}</p>
  </div>
</div>